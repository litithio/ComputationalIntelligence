\section{Simulationsregeln des digitalen Zwillings}

\paragraph{Zeitachse und Simulationshorizont} Wir arbeiten auf dem Zeitintervall \([0,T]\) mit \(T=24\,\mathrm{h}\) (ein Kalendertag: 00{:}00 bis 24{:}00). Für die folgenden Tageszeitfenster ordnen wir jeder absoluten Zeit \(t\) ihren Tageszeitwert über die Abbildung \(t \mapsto t \bmod 24\,\mathrm{h}\) zu, die Werte in \([0,24\,\mathrm{h})\) liefert.
\medskip
% --- Basalrate konstant -----------------------------------------
\newcommand{\ubasal}{\bar u_{\mathrm{basal}}}
\paragraph{Basalrate}
Die Basalrate ist konstant und liefert den Hintergrundbedarf: $u_{\mathrm{basal}}(t)=\ubasal$ für alle $t\in[0,T]$. Sie stabilisiert den nüchternen Glukoseverlauf (hepatische Glukoseproduktion) und bleibt im Quartal fix, damit der Optimierer ausschließlich die Effekte der Mahlzeitenfaktoren $\ICR_f,\ICR_m,\ICR_a$ lernt. Tageszeitlich variierende Basalprofile oder automatische Anpassungen (AID) sind hier bewusst deaktiviert und können in einer Erweiterung als zusätzliche Entscheidungsvariablen aufgenommen werden.

% --- Tageszeitfenster (über 24h periodisch) ---------------------
\newcommand{\tod}{\mathrm{tod}}
\medskip

\paragraph{Tageszeitfenster und Zuordnung der ICR-Werte}
Zur Zuordnung der drei ICRs zu Tageszeiten definieren wir die Tageszeitabbildung \( \tod(t):= t \bmod 24\,\mathrm{h} \in [0,24\,\mathrm{h})\). Damit seien die vier Fenster
\[
\begin{aligned}
\mathcal{W}_{\mathrm{Morgen}} &:= \{\, t\in[0,T] \mid 5\,\mathrm{h} \le \tod(t) < 10\,\mathrm{h} \,\},\\
\mathcal{W}_{\mathrm{Mittag}} &:= \{\, t\in[0,T] \mid 10\,\mathrm{h} \le \tod(t) < 16\,\mathrm{h} \,\},\\
\mathcal{W}_{\mathrm{Abend}}  &:= \{\, t\in[0,T] \mid 16\,\mathrm{h} \le \tod(t) < 22\,\mathrm{h} \,\},\\
\mathcal{W}_{\mathrm{Nacht}}  &:= \{\, t\in[0,T] \mid 22\,\mathrm{h} \le \tod(t) < 24\,\mathrm{h} \ \text{oder}\ 0\,\mathrm{h} \le \tod(t) < 5\,\mathrm{h} \,\}.
\end{aligned}
\]
Diese vier Fenster bilden (tagesperiodisch) eine Zerlegung von \([0,T]\). Die für die Optimierung relevanten ICR-Werte sind stückweise konstant über die Fenster definiert:
\[
\ICR(t)=
\begin{cases}
\ICRf, & t \in \mathcal{W}_{\mathrm{Morgen}},\\
\ICRm, & t \in \mathcal{W}_{\mathrm{Mittag}},\\
\ICRa, & t \in \mathcal{W}_{\mathrm{Abend}},\\
\text{(keine Mahlzeiten-ICR)}, & t \in \mathcal{W}_{\mathrm{Nacht}}.
\end{cases}
\]
\noindent In der Nacht \(\mathcal{W}_{\mathrm{Nacht}}\) werden keine Mahlzeitenboli verabreicht.
\medskip

% Bolus-Ereignisse (zeitlich sortiert)
\paragraph{Mindestabstand zwischen Bolusgaben}
Sei \(\Dtmin\) der festgelegte Mindestabstand zwischen zwei Bolusgaben (hier: \(30\,\mathrm{min}\)). Wir modellieren Bolusereignisse durch ihre absoluten Zeitpunkte \(\tau_1<\tau_2<\dots<\tau_N\) auf dem Intervall \([0,T]\). Die folgende Regel erzwingt, dass nach einer Gabe mindestens \(\Dtmin\) vergeht, bevor die nächste Gabe zulässig ist (Stacking-Vermeidung):
\[
\tau_{n+1} - \tau_n \;\ge\; \Dtmin \qquad \forall\, n=1,\dots,N-1.
\]